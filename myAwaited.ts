// Awaited (–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ Promise)
// üìù –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏
// –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ç–∏–ø MyAwaited<T>, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º—É Awaited.
// –û–Ω –¥–æ–ª–∂–µ–Ω "—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å" Promise –∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. –ï—Å–ª–∏ Promise –≤–ª–æ–∂–µ–Ω–Ω—ã–π (Promise<Promise<string>>), –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –∏—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–æ —Å–∞–º–æ–≥–æ –¥–Ω–∞.

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

// // –ü—Ä–æ—Å—Ç–æ–π Promise
// type X = MyAwaited<Promise<string>>;
// // –û–∂–∏–¥–∞–µ—Ç—Å—è: string

// // –í–ª–æ–∂–µ–Ω–Ω—ã–π Promise
// type Y = MyAwaited<Promise<Promise<number>>>;
// // –û–∂–∏–¥–∞–µ—Ç—Å—è: number

// // –û–±—ä–µ–∫—Ç —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º Promise (PromiseLike)
// interface User { name: string; age: number }
// type Z = MyAwaited<Promise<User>>;
// // –û–∂–∏–¥–∞–µ—Ç—Å—è: User

interface User {
    name: string;
    age: number;
    role: "admin" | "user";
}

type ApiUser = myAwaited<Promise<Promise<User>>>;

type myAwaited<T> = T extends PromiseLike<infer T1> ? myAwaited<T1> : T;

// –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
// –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç—Ä–∏ –º–æ—â–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ TypeScript:

// PromiseLike: –í–º–µ—Å—Ç–æ –∂–µ—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –∫ Promise, –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ PromiseLike.
// –≠—Ç–æ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∏ –æ–±—ã—á–Ω—ã–µ –ø—Ä–æ–º–∏—Å—ã, –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –º–µ—Ç–æ–¥ .then (—á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É Promises/A+).

// infer R: –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ infer –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º "–≤—ã—Ç–∞—â–∏—Ç—å" —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –¥–∂–µ–Ω–µ—Ä–∏–∫–∞.

// –ï—Å–ª–∏ T —ç—Ç–æ Promise<string>, —Ç–æ infer R –∑–∞—Ö–≤–∞—Ç–∏—Ç string.
// –†–µ–∫—É—Ä—Å–∏—è:

// –£—Å–ª–æ–≤–∏–µ: T extends PromiseLike<infer R>?
// –î–∞: –ú—ã –Ω–∞—à–ª–∏ —á—Ç–æ-—Ç–æ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ–º–∏—Å–∞ (R). –ù–æ –≤–¥—Ä—É–≥ —Ç–∞–º –≤–Ω—É—Ç—Ä–∏ –µ—â–µ –æ–¥–∏–Ω –ø—Ä–æ–º–∏—Å? –ü–æ—ç—Ç–æ–º—É –º—ã —Å–Ω–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ–º MyAwaited<R> –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞.
// –ù–µ—Ç: –ï—Å–ª–∏ T –±–æ–ª—å—à–µ –Ω–µ –ø–æ—Ö–æ–∂ –Ω–∞ Promise (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –¥–æ–±—Ä–∞–ª–∏—Å—å –¥–æ string –∏–ª–∏ User), –º—ã –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º T.

// –ü–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: MyAwaited<Promise<Promise<number>>>
// –®–∞–≥ 1: –í—Ö–æ–¥ Promise<Promise<number>>.

// –≠—Ç–æ PromiseLike? –î–∞.
// infer R –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—å: Promise<number>.
// –í—ã–∑—ã–≤–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏—é: MyAwaited<Promise<number>>.
// –®–∞–≥ 2: –í—Ö–æ–¥ Promise<number>.

// –≠—Ç–æ PromiseLike? –î–∞.
// infer R –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—å: number.
// –í—ã–∑—ã–≤–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏—é: MyAwaited<number>.
// –®–∞–≥ 3: –í—Ö–æ–¥ number.

// –≠—Ç–æ PromiseLike? –ù–µ—Ç.
// –í–æ–∑–≤—Ä–∞—â–∞–µ–º T (number).

// üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
// infer: –í—ã–≤–æ–¥ —Ç–∏–ø–∞ –≤–Ω—É—Ç—Ä–∏ —É—Å–ª–æ–≤–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è.
// Recursive Types: –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ç–∏–ø–∞ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —Å–∞–º–æ–≥–æ —Å–µ–±—è.
// PromiseLike<T>: –£—Ç–∏–ª–∏—Ç–Ω—ã–π —Ç–∏–ø –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –ª—é–±—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏-–ø—Ä–æ–º–∏—Å–∞–º–∏.
